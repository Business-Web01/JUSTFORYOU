<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Special Letter</title>
    <style>
        :root {
            --pink-bg: #fff0f5;
            --envelope-color: #f06292;
            --flap-color: #e91e63;
            --red-accent: #d32f2f;
        }

        body {
            margin: 0; 
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            font-family: 'Georgia', serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .main-nav {
    width: 100%;
    background: #f06292; /* Consistent Pink */
    padding: 15px 0;
    display: flex;
    justify-content: center;
    gap: 15px;
    position: sticky;
    top: 0;
    z-index: 1000;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    overflow-x: auto; /* Allows horizontal scroll on very small phones */
    white-space: nowrap;
}

.main-nav a {
    text-decoration: none;
    color: white;
    font-weight: bold;
    font-size: 0.85rem;
    text-transform: uppercase;
    padding: 5px 10px;
    transition: color 0.3s ease;
}

.main-nav a:hover {
    color: #ffebee; /* Light pink hover effect */
}

/* Mobile Tweak: Ensure links don't get squashed */
@media (max-width: 480px) {
    .main-nav {
        justify-content: flex-start; /* Aligns to left so user can scroll across */
        padding-left: 15px;
    }
    .main-nav a {
        font-size: 0.75rem;
    }
}

.main-nav a.active {
    border-bottom: 2px solid white;
}


        .instruction {
            margin-bottom: 25px;
            color: white; /* Changed to white to stand out against background */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            font-weight: bold;
            font-size: 1.4rem;
            z-index: 5;
        }

        /* --- ENLARGED ENVELOPE --- */
        .envelope-wrapper {
            position: relative;
            width: 95%;
            max-width: 550px; /* Enlarge from 450px */
            height: 350px;     /* Enlarge from 280px */
            background: var(--envelope-color);
            border-radius: 0 0 15px 15px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.4);
            cursor: pointer;
            perspective: 1500px;
        }

        /* The Closed Flap - Adjusted for larger size */
        .flap {
            position: absolute;
            top: 0; left: 0;
            width: 0; height: 0;
            border-left: 275px solid transparent; /* Half of 550 */
            border-right: 275px solid transparent;
            border-top: 200px solid var(--flap-color);
            transform-origin: top;
            transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 10;
        }

        /* The Heart Seal */
        .heart-seal {
            position: absolute;
            top: 160px; /* Adjusted for larger flap */
            left: 50%;
            transform: translateX(-50%);
            font-size: 60px; /* Slightly larger */
            z-index: 11;
            animation: wiggle 1.2s infinite;
            transition: opacity 0.3s;
        }

        @keyframes wiggle {
            0%, 100% { transform: translateX(-50%) rotate(0deg); }
            25% { transform: translateX(-50%) rotate(-8deg); }
            75% { transform: translateX(-50%) rotate(8deg); }
        }

        .envelope-wrapper.open .flap {
            transform: rotateX(180deg);
            z-index: 0;
        }
        .envelope-wrapper.open .heart-seal {
            opacity: 0;
        }

        /* --- LETTER MODAL --- */
        #letter-modal {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .letter-content {
            background: #fff;
            width: 85%;
            max-width: 450px;
            min-height: 520px;
            padding: 35px;
            border-radius: 12px;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            border: 10px solid white;
            outline: 5px dashed var(--red-accent);
        }

        .close-btn { position: absolute; top: 10px; right: 15px; font-size: 30px; cursor: pointer; font-weight: bold; }
        .page-text { font-size: 1.2rem; line-height: 1.7; color: #333; white-space: pre-wrap; }
        .nav-arrow { align-self: flex-end; font-size: 2.5rem; color: #f06292; cursor: pointer; }

        /* Rating & Alerts */
        #rating-popup { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); text-align: center; display: none; z-index: 3000; width: 85%; max-width: 350px; }
        .heart-star { font-size: 2.5rem; cursor: pointer; color: #ccc; }
        .heart-star.selected { color: var(--red-accent); }
        .btn-action { background: var(--red-accent); color: white; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; cursor: pointer; margin-top: 15px; font-size: 1rem; }

        .alert-box { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); padding: 30px; border-radius: 15px; color: white; font-weight: bold; display: none; z-index: 4000; text-align: center; width: 280px; font-size: 1.1rem; }
        .alert-red { background: #ff0000; animation: flashRed 0.5s infinite; }
        .alert-green { background: #2ecc71; animation: flashGreen 0.5s infinite; }

        @keyframes flashRed { 50% { opacity: 0.4; } }
        @keyframes flashGreen { 50% { opacity: 0.7; } }

        /* --- MOBILE ADJUSTMENTS --- */
        @media (max-width: 600px) {
            .envelope-wrapper { height: 280px; }
            .flap { 
                border-left-width: 47.5vw; 
                border-right-width: 47.5vw; 
                border-top-width: 180px; 
            }
            .heart-seal { top: 130px; font-size: 50px; }
            .instruction { font-size: 1.1rem; }
        }
    </style>
</head>
<body onclick="spawnHearts(event)">

    <nav>
        <a href="index.html">Home</a>
        <a href="love letter.html">Letter</a>
        <a href="puzzle.html">Puzzle</a>
        <a href="wordsearch.html">Word Search</a>
        <a href="quiz.html">Things I Love About You</a>
        <a href="song.html">SongForYou</a>
        <a href="collage.html">Our Collage</a>
    </nav>

    <div class="instruction">Tap the heart to open</div>

    <div class="envelope-wrapper" id="envelope" onclick="openLetter()">
        <div class="flap"></div>
        <div class="heart-seal">❤️</div>
    </div>

    <div id="letter-modal">
        <div class="letter-content">
            <span class="close-btn" onclick="closeLetter()">×</span>
            <div style="font-weight: bold; color: var(--red-accent); margin-bottom: 15px; font-size: 1.1rem;">FROM: MBALZ<br>TO: MY VALENTINE (LEIGH)</div>
            <div id="letter-body" class="page-text"></div>
            <div id="next-arrow" class="nav-arrow" onclick="nextPage()">➔</div>
        </div>
    </div>

    <div id="rating-popup">
        <h3>How much would you rate my letter?</h3>
        <div class="hearts-rating">
            <span class="heart-star" onclick="rate(1)">❤</span>
            <span class="heart-star" onclick="rate(2)">❤</span>
            <span class="heart-star" onclick="rate(3)">❤</span>
            <span class="heart-star" onclick="rate(4)">❤</span>
            <span class="heart-star" onclick="rate(5)">❤</span>
        </div>
        <button class="btn-action" onclick="submitRating()">Submit</button>
    </div>

    <div id="alert-error" class="alert-box alert-red">Please try again! ❌</div>
    <div id="alert-success" class="alert-box alert-green">
        ARGH! You are such a sweetheart i knew you loved my letter! ❤️<br><br>
        <button class="btn-action" style="background:white; color:#2ecc71;" onclick="goToQuiz()">Next: The Quiz</button>
    </div>

    <script>
        const pages = [
            "My Dearest Leigh,\n\nI wanted to take this moment to tell you just how special you are to me. Meeting you was the best thing that ever happened...",
            "Every laugh we share and every moment we spend together makes my life so much brighter. You truly are one of a kind.",
            "I hope this Valentine's Day is just the beginning of many more beautiful memories together.\n\nLove always,\nMbalz"
        ];
        
        let currentPage = 0;
        let selectedRating = 0;

        function openLetter() {
            document.getElementById('envelope').classList.add('open');
            setTimeout(() => {
                document.getElementById('letter-modal').style.display = 'flex';
                updatePage();
            }, 700);
        }

        function updatePage() {
            document.getElementById('letter-body').innerText = pages[currentPage];
            document.getElementById('next-arrow').style.display = (currentPage === pages.length - 1) ? 'none' : 'block';
        }

        function nextPage() {
            currentPage++;
            updatePage();
        }

        function closeLetter() {
            document.getElementById('letter-modal').style.display = 'none';
            document.getElementById('rating-popup').style.display = 'block';
        }

        function rate(num) {
            selectedRating = num;
            document.querySelectorAll('.heart-star').forEach((s, i) => s.classList.toggle('selected', i < num));
        }

        function submitRating() {
            if (selectedRating < 5) {
                showAlert('alert-error');
            } else {
                showAlert('alert-success');
            }
        }

        function showAlert(id) {
            const el = document.getElementById(id);
            el.style.display = 'block';
            if (id === 'alert-error') setTimeout(() => el.style.display = 'none', 2000);
        }

        function goToQuiz() { window.location.href = "quiz.html"; }

        function spawnHearts(e) {
            const h = document.createElement('div');
            h.innerHTML = '❤️';
            h.style.cssText = `position:fixed; left:${e.clientX}px; top:${e.clientY}px; pointer-events:none; animation:floatUp 3s forwards; z-index:5000; font-size: 24px;`;
            document.body.appendChild(h);
            setTimeout(() => h.remove(), 3000);
        }
    </script>

    <style>
        @keyframes floatUp { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-120px); opacity: 0; } }
    </style>
</body>
</html>